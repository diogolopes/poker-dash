drop table colocacao if exists;
drop table partida if exists;
drop table partida_pessoa if exists;
drop table pessoa if exists;
drop table ranking if exists;
create table colocacao (id integer generated by default as identity, version bigint, derrota integer not null, empate integer not null, jogos integer not null, posicao_anterior integer not null, posicao_atual integer not null, saldo decimal(19,2), vitoria integer not null, pessoa_id integer not null, ranking_id integer not null, primary key (id));
create table partida (id integer generated by default as identity, version bigint, data timestamp not null, local varchar(255), primary key (id));
create table partida_pessoa (version bigint, bonus decimal(19,2), saldo decimal(19,2), partida_id integer not null, pessoa_id integer not null, primary key (partida_id, pessoa_id));
create table pessoa (id integer generated by default as identity, version bigint, codigo integer, email varchar(255), nome varchar(200) not null, telefone varchar(255), primary key (id));
create table ranking (id integer generated by default as identity, version bigint, ano integer not null, data_atualizacao timestamp not null, ranking_type varchar(255) not null, primary key (id));
alter table colocacao add constraint UKmftpost3jme083m77o90ens7f unique (ranking_id, pessoa_id);
alter table partida add constraint UK_cy8l71eeb4vcmjjywaxj5nb7e unique (data);
create index idx_pessoa_nome on pessoa (nome);
create index idx_pessoa_codigo on pessoa (codigo);
alter table pessoa add constraint UK_ppfc4sjk52dk2jex4f880oifm unique (nome);
alter table colocacao add constraint FKa0jl9wf2qpuli1tjot98cydee foreign key (pessoa_id) references pessoa;
alter table colocacao add constraint FKhvth9hsj7sxdm2yea0x3h0t5q foreign key (ranking_id) references ranking;
alter table partida_pessoa add constraint FK8vysfy8ov0tx47uirb2tlw2eo foreign key (partida_id) references partida;
alter table partida_pessoa add constraint FK2jri8uwmdkfn18w7eg83h8ne6 foreign key (pessoa_id) references pessoa;